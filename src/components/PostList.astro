---
import PostPreview from './PostPreview.astro'
import { getCollection } from 'astro:content';


const posts = await getCollection("posts");
const sortedPosts = posts
    .map(post => {
        return {...post.data, slug: post.slug};
    })    
    .sort((a: any, b: any) => {
        return new Date(b.publishDate).valueOf() - new Date(a.publishDate).valueOf();
    })
    .filter((post: any) => {
        return post.title !== "About Me" && !post.draft;
    });
---
<style>

  content {
    /* MODIFICATION: Control the space below the header here */
    margin-top: 2rem; 
  }

  ul {
    list-style: none;
    display: flex;
    flex-direction: column;
    width: 100%;
    padding: 0;

    /* MODIFICATION: Remove the old gap to use borders instead */
    gap: 0;
  }

  
  ul > :global(li) {
    padding-bottom: 2.5rem; /* Space below the content */
    margin-bottom: 2.5rem; /* Space below the border */
    border-bottom: 1px solid var(--border-subtle, #475569);
  }

  /* Ensure the last post doesn't have a border or extra space */
  ul > :global(li:last-child) {
    border-bottom: none;
    margin-bottom: 0;
  }
</style>

<content>
    {sortedPosts.length === 0 ? <p>No posts yet!</p> : 
        <ul>
            {sortedPosts.map((post: any) => 
                <PostPreview 
                    title={post.title} 
                    publishDate={new Date(post.publishDate).toLocaleDateString("en-US", {
                        year: "numeric",
                        month: "long",
                        day: "numeric"
                    })})
                    author={post.author}
                    description={post.description}
                    slug={post.slug}
                />)}
        </ul>
    }
</content>


